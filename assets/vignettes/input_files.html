<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>R/qtl2 input file format</title>
    <meta name="description" content="Input file format for R/qtl2">
    <meta name="author" content="Karl Broman">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://kbroman.org/qtl2/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="http://kbroman.org/qtl2/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="http://kbroman.org/qtl2/assets/themes/twitter/css/kbroman.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->

    <!-- atom & rss feed -->
    <link href="http://kbroman.org/qtl2nil" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="http://kbroman.org/qtl2nil" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="http://kbroman.org/qtl2">R/qtl2</a>

          <ul class="nav">
              <li><a href="http://kbroman.org/qtl2/docs.html">documentation</a></li>
              <li><a href="http://kbroman.org/qtl2/assets/vignettes/user_guide.html">user guide</a></li>
              <li><a href="http://kbroman.org/qtl2/assets/vignettes/input_files.html">input files</a></li>
              <li><a href="http://kbroman.org/qtl2/pages/sampledata.html">sample data</a></li>
          </ul>

        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">


<div class="page-header">
  <h2>R/qtl2 input file format</h2>
</div>

<div class="row-fluid">
  <div class="span12">
<div><div> <!-- useless divs to match 2 extra </div> at the end -->






<p><a href="http://kbroman.org/qtl2">R/qtl2</a> (aka qtl2) is a reimplementation of the QTL analysis software <a href="https://rqtl.org">R/qtl</a>, to better handle high-dimensional data and complex cross designs.</p>
<p>The input data file formats for <a href="https://rqtl.org">R/qtl</a> cannot handle complex crosses, and so for R/qtl2, we need to define a new input file format. This document describes the details.</p>
<p>For simple cross types, we can continue to use the file formats for <a href="https://rqtl.org">R/qtl</a>, use <code>qtl::read.cross()</code> to read in the data, and then use a conversion function (<code>qtl2geno::convert2cross2()</code>) to convert the data into the new format.</p>
<p>For more complex crosses, we need to define a new format. I was persuaded by <a href="http://aaronwolen.com/">Aaron Wolen</a>’s idea of a <a href="https://github.com/kbroman/qtl/pull/20">“tidy” format</a> for <a href="https://rqtl.org">R/qtl</a>, with three separate CSV files, one for phenotypes, one for genotypes, and one for the genetic map.</p>
<p>Another important idea is from <a href="http://thebird.nl/">Pjotr Prins</a>’s <a href="https://github.com/qtlHD/qtlHD/blob/master/doc/input/qtab.md">qtab format</a>: the inclusion of metadata, such as genotype encodings, with the primary data. This will simplify the handling of multiple files and will help to avoid mistakes.</p>
<p>And so the basic idea for the new format is to have a separate file for each part of the primary data (genotypes, founder genotypes, genetic map, physical map, phenotypes, covariates, and phenotype covariates), and then a control file (in <a href="http://www.yaml.org">YAML</a> or <a href="http://www.json.org">JSON</a> format) which specifies the names of all of those files, the genotype encodings and missing value codes, and things like the name of the sex column within the covariate data (and the encodings for the sexes) and which chromosome is the X chromosome.</p>
<div id="reading-the-data-files" class="section level2">
<h2>Reading the data files</h2>
<p>Before discussing the boring file specifications, let’s consider briefly how the data are read into R.</p>
<p>A key advantage of the control file scheme is that it greatly simplifies the function for reading in the data. That function, <code>read_cross2()</code>, has a <em>single</em> argument: the name (with path) of the control file. So you can read in data like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(qtl2geno)
grav2 &lt;-<span class="st"> </span><span class="kw">read_cross2</span>(<span class="st">&quot;~/my_data/grav2.yaml&quot;</span>)</code></pre></div>
<p>The large number of files is a bit cumbersome, so we’ve made it possible to use a <a href="https://en.wikipedia.org/wiki/Zip_(file_format)">zip file</a> containing all of the data files, and to read that zip file directly. There’s even a function for creating the zip file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">zip_datafiles</span>(<span class="st">&quot;~/my_data/grav2.yaml&quot;</span>)</code></pre></div>
<p>The <code>zip_datafiles()</code> function will read the control file to identify all of the relevant data files and then zip them up into a file with the same name and location, but with the extension <code>.zip</code> rather than <code>.yaml</code> or <code>.json</code>.</p>
<p>To read the data back in, we use the same <code>read_cross2()</code> function, providing the name (and path) of the zip file rather than the control file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grav2 &lt;-<span class="st"> </span><span class="kw">read_cross2</span>(<span class="st">&quot;~/my_data/grav2.zip&quot;</span>)</code></pre></div>
<p>This can even be done with remote files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grav2 &lt;-<span class="st"> </span><span class="kw">read_cross2</span>(<span class="st">&quot;http://kbroman.org/qtl2/assets/sampledata/grav2/grav2.zip&quot;</span>)</code></pre></div>
<p>Of course, the other advantage of the zip file is that it is <em>compressed</em> and so smaller than the combined set of CSV files.</p>
</div>
<div id="format-of-the-data-files" class="section level2">
<h2>Format of the data files</h2>
<p>The bulk of the data is in a set of comma-delimited (CSV) files. In addition, a control file (in <a href="http://www.yaml.org">YAML</a> or <a href="http://www.json.org">JSON</a> format), contained in the same directory as the CSV files, specifies the file names and other control parameters (such as genotype and sex encodings). Sample data files are available at <a href="http://kbroman.org/qtl2/pages/sampledata.html">the R/qtl2 website</a>. We’ll discuss the CSV files first.</p>
<div id="csv-files" class="section level3">
<h3>CSV files</h3>
<p>The comma-delimited (CSV) files are each in the form of a simple matrix, with the first column being a set of IDs and the first row being a set of variable names.</p>
<p>Missing value codes will be specified in the control file (as <code>na.strings</code>, with default value <code>&quot;NA&quot;</code>) and will apply across all files, so a missing value code for one file cannot be an allowed value in another file.</p>
<p>The CSV files can include a header with a set of comment lines initiated by a value specified in the control file as <code>comment.char</code> (with default value <code>&quot;#&quot;</code>). The first such line could be a description of the contents of the file. These comment lines can include the expected number of rows and columns, like this:</p>
<pre><code># This file contains blah, blah, blah...
# nrow 25012
# ncol 91</code></pre>
<p>The number of rows (<code>nrow</code>) includes <em>only</em> the data rows (<em>not</em> the comment rows, <em>nor</em> the row with variable names). On the other hand, the number of columns (<code>ncol</code>) <em>does include</em> the column with individual IDs.</p>
<p>All of these CSV files may be transposed relative to the form described below. You just need to include, in the control file, a line like</p>
<pre><code>geno_transposed: true</code></pre>
<div id="genotype-and-founder-genotype-data" class="section level4">
<h4>Genotype and founder genotype data</h4>
<p>The genotype data file is a matrix of individuals × markers. The first column is the individual IDs; the first row is the marker names. The founder genotypes (if needed) are in the same form, with founder lines as rows and markers as columns, and with founder IDs in the first column.</p>
</div>
<div id="phenotype-and-covariate-data" class="section level4">
<h4>Phenotype and covariate data</h4>
<p>We split the numeric phenotypes from the mixed-mode covariates, as two separate CSV files. Each file forms a matrix of individuals × phenotypes (or covariates), with the first column being individual IDs and the first row being phenotype or covariate names. Sex and line IDs (if needed) can be columns in the covariate data.</p>
</div>
<div id="phenotype-covariates" class="section level4">
<h4>Phenotype covariates</h4>
<p>A separate CSV file contains phenotype covariate data, as phenotypes × phenotype covariates. The first column contains phenotype names, and the first row contains the names of the phenotype covariates.</p>
<p><strong>Note</strong>: The genotype, founder genotype, phenotype, covariate, and phenotype covariate data can be split across multiple files. For example, the genotype data could be split by chromosome. The individual IDs must appear in each file; these are used to combine the files.</p>
</div>
<div id="genetic-and-physical-maps" class="section level4">
<h4>Genetic and physical maps</h4>
<p>Genetic and physical maps of the genotyped markers will be as separate CSV files, each with three columns: marker, chromosome, and position. The first row should be <code>marker,chr,pos</code> but will be ignored. In the genetic map file, positions should be in centiMorgans (cM). In the physical map file, positions should be in megabasepairs (Mbp).</p>
</div>
<div id="cross-information" class="section level4">
<h4>Cross information</h4>
<p>The <code>&quot;cross_info&quot;</code> data specifies details of the cross that generated each individual and is a numeric matrix with individuals as rows (the same number of rows as in the genotype data) and with columns depending on the cross type.</p>
<p>For simple cross types (e.g., <code>&quot;f2&quot;</code>, an intercross between two inbred lines), this cross information may be included as a column in the covariate data. More generally, the cross information will be a separate CSV file. For example, for a set of Collaborative Cross (CC) lines, we will want a matrix with eight columns, which indicate the order of the founders in the crosses that generated each CC line.</p>
<p>So, in general, the cross information will be in a CSV file with individuals as rows and a set of columns that define the cross information for that cross type. The first column contains individual IDs and the first row contains column names. Details on the column information are provided in the cross-type-specific information, below.</p>
</div>
</div>
<div id="control-file" class="section level3">
<h3>Control file</h3>
<p>The new input file format includes a text-based control file (in <a href="http://www.yaml.org">YAML</a> or <a href="http://www.json.org">JSON</a> format) to specify the names of all of the other files as well as various control parameters such as genotype and sex encodings and codes for missing values. We use <a href="http://www.yaml.org">YAML</a> because it is flexible, readable, and easy to import into R. We also allow <a href="http://www.json.org">JSON</a>; though it is often less human-readable, it can be less prone to errors.</p>
<p>The format of the control file is a bit technical. We describe the details here and also provide a function <code>write_control_file()</code> that takes the detailed specifications as input and contructs the control file in the correct format.</p>
<p>We’ll start with an example: the control file for the <a href="http://kbroman.org/qtl2/pages/sampledata">sample intercross data</a>.</p>
<pre><code># Data from Grant et al. (2006) Hepatology 44:174-185
# Abstract of paper at PubMed: https://www.ncbi.nlm.nih.gov/pubmed/16799992
# Available as part of R/qtl book package, https://github.com/kbroman/qtlbook
crosstype: f2
geno: iron_geno.csv
pheno: iron_pheno.csv
phenocovar: iron_phenocovar.csv
covar: iron_covar.csv
gmap: iron_gmap.csv
alleles:
- S
- B
genotypes:
  SS: 1
  SB: 2
  BB: 3
sex:
  covar: sex
  f: female
  m: male
cross_info:
  covar: cross_direction
  (SxB)x(SxB): 0
  (BxS)x(BxS): 1
x_chr: X
na.strings:
- '-'
- NA</code></pre>
<p>Any line that begins with a “<code>#</code>” is treated as a comment and ignored. It’s good to include some comments at the top of the file, describing the dataset.</p>
<p>The order of things within the file is not important, but the names of things are critical.</p>
<p>Much of the information is represented as key-value pairs, as “<code>key: value</code>.” For example, the cross type is indicated with a line like</p>
<pre><code>crosstype: f2</code></pre>
<p>The “<code>key</code>” is “<code>crosstype</code>” and the “<code>value</code>” is “<code>f2</code>.” This indicates that the data are for an F<sub>2</sub> intercross between two inbred lines.</p>
<div id="file-names" class="section level4">
<h4>File names</h4>
<p>The names of the basic CSV files are indicated with lines like</p>
<pre><code>geno: iron_geno.csv</code></pre>
<p>This indicates that the genotype data are in the file <code>iron_geno.csv</code>. The files are expected to be in the same directory as the control file. They could be placed in separate directories, with the file names being paths relative to the location of the control file, but this is not recommended (or well tested).</p>
<p>The “keys” for the different files are the following:</p>
<pre><code>geno:         genotype_filename
founder_geno: founder_genotype_filename
pheno:        phenotype_filename
covar:        covariate_filename
phenocovar:   phenotype_covariate_filename
gmap:         genetic_map_filename
pmap:         physical_map_filename</code></pre>
<p>Most of these files are optional; if a particular file is not used, the corresponding key can be omitted from the control file.</p>
<p>If the data for a section is split into multiple files (for example, if the genotypes are split into chromosome-specific files), then a vector of file names should be provided. For example:</p>
<pre><code>geno:
  - geno1.csv
  - geno2.csv
  - genoX.csv
founder_geno:
  - founder_geno1.csv
  - founder_geno2.csv
  - founder_genoX.csv</code></pre>
</div>
<div id="x-chromosome" class="section level4">
<h4>X chromosome</h4>
<p>If one of the chromosomes is to be treated as the X chromosome, there should be a line like</p>
<pre><code>x_chr: X</code></pre>
<p>This specifies the chromosome ID for the X chromosome (<code>X</code> in this case).</p>
</div>
<div id="allele-labels" class="section level4">
<h4>Allele labels</h4>
<p>To add labels in summary tables and plots, provide a vector of single-character allele labels, with one for each founder line. For example,</p>
<pre><code>alleles:
- S
- B</code></pre>
<p>This list of items, each beginning with a hyphen and a space, is the YAML format for a vector. It is equivalent to the R code <code>c(&quot;S&quot;, &quot;B&quot;)</code>.</p>
<p>You could also write this line as</p>
<pre><code>alleles: [S, B]</code></pre>
<p>which is an alternative format for vectors in YAML.</p>
</div>
<div id="genotype-codes" class="section level4">
<h4>Genotype codes</h4>
<p>The control file should contain a record with “<code>genotypes:</code>” that specifies the genotype encodings. Here’s an example:</p>
<pre><code>genotypes:
  SS: 1
  SB: 2
  BB: 3</code></pre>
<p>For each possible genotype code, indent and provide a “<code>key: value</code>” pair, with the key being the code used in the genotype and founder genotype files, and the value being an integer to which the genotype should be converted.</p>
<p>The above example would be suitable for a backcross or intercross. For a backcross, the second homozygote (<code>BB</code> in this case) is only needed in the case that there are X chromosome genotypes for males.</p>
<p>For RIL, we would use something like</p>
<pre><code>genotypes:
  BB: 1
  DD: 2</code></pre>
<p>For crosses with multiple parents, the genotype file should contain genotype calls for a set of SNPs, and there should be a corresponding founder genotype file with genotypes of the founders at those SNPs. A common set of genotype codes needs to be used for all SNPs. In particular, the genotypes <strong>cannot</strong> be encoded as <code>AA</code>, <code>CC</code>, <code>GG</code>, <code>TT</code>, <code>AC</code>, <code>AG</code>, because then, e.g., <code>CC</code> would need to be treated as <code>1</code> for some SNPs and <code>3</code> for others. Instead, code the genotypes with something like <code>AA</code>, <code>AB</code>, <code>BB</code>, and then include the following in the control file:</p>
<pre><code>genotypes:
  AA: 1
  AB: 2
  BB: 3</code></pre>
</div>
<div id="sex" class="section level4">
<h4>Sex</h4>
<p>Sex can be provided as a column in the covariate file or as a separate file.</p>
<p>If it is a column in the covariate file, the control file should have a section that looks like this:</p>
<pre><code>sex:
  covar: sex
  f: female
  m: male</code></pre>
<p>Here, “<code>covar: sex</code>” indicates that the column name used in the covariate file is “<code>sex</code>.” If the column name were “<code>Sex</code>,” you would write “<code>covar: Sex</code>.”</p>
<p>The other two “<code>key: value</code>” pairs are the encodings used for sex, with the “keys” being the codes used in the covariate file and the “values” being <code>female</code> and <code>male</code>. So this indicates that sex was encoded as <code>f</code> for females and <code>m</code> for males. If, instead, the sex covariate had <code>0</code> for females and <code>1</code> for males, you would use:</p>
<pre><code>sex:
  covar: sex
  0: female
  1: male</code></pre>
<p>Sex information can also be provided as a separate file. In this case, the file should have two columns: individual ID, and sex. Further, the part of the control file dealing with sex should look like this:</p>
<pre><code>sex:
  file: sex_filename
  f: female
  m: male</code></pre>
<p>So instead of a line with “<code>covar:</code>,” use “<code>file:</code>” followed by the name of the file (e.g., “<code>file: iron_sex.csv</code>”). You must still provide the sex encodings, as before.</p>
</div>
<div id="cross-information-1" class="section level4">
<h4>Cross information</h4>
<p>For simple crosses (e.g., an intercross), cross information can be a single column within the covariate file. In this case, include something like the following in the control file:</p>
<pre><code>cross_info:
  covar: cross_direction
  (SxB)x(SxB): 0
  (BxS)x(BxS): 1</code></pre>
<p>This is much like the information for sex. The “<code>covar:</code>” line indicates the name of the column in the covariate data that corresponds to the cross information. The other two lines indicate the encodings of the cross information as “<code>key: value</code>” pairs, where “<code>key</code>” is the code used in the cross information column and “<code>value</code>” is the integer to which it should be converted.</p>
<p>More generally, the cross information would be contained in a separate comma-delimited file. For simple crosses, in which the cross information is a single column, we allow it to be encoded differently from what is needed, and the control file information should look like this:</p>
<pre><code>cross_info:
  file: crossinfo_filename
  (SxB)x(SxB): 0
  (BxS)x(BxS): 1</code></pre>
<p>For more complex crosses (e.g., the Collaborative Cross), the cross information spans multiple columns and we require that the user have set this up in advance (i.e., no translation of encodings will be performed). In this case the relevant section of the control file looks like this:</p>
<pre><code>cross_info:
  file: crossinfo_filename</code></pre>
<p>Or, more simply, you could write:</p>
<pre><code>cross_info: crossinfo_filename</code></pre>
</div>
<div id="missing-value-codes" class="section level4">
<h4>Missing value codes</h4>
<p>To indicate the set of codes that are to be treated as missing values in the genotype, founder genotype, phenotype, covariate, and phenotype covariate files, define <code>na.strings</code> within the control file:</p>
<pre><code>na.strings:
- NA
- '-'</code></pre>
<p>A hyphen needs to be surrounded in single- or double-quotes. Many other character strings (such as <code>NA</code>) do not. This is a similar contruction as for the allele codes above; the list with hyphens followed a space is the YAML format for a vector. You could also write:</p>
<pre><code>na.strings: [NA, '-']</code></pre>
<p>which is another way to define a vector with YAML.</p>
</div>
<div id="field-separator" class="section level4">
<h4>Field separator</h4>
<p>If the data files use a separator other than a comma (e.g., a semi-colon, or the vertical bar (<code>|</code>) which I like because it is seldom present in data), indicate the separator within the control file, as follows:</p>
<pre><code>sep: '|'</code></pre>
<p>A vertical bar needs to be surrounded by single- or double-quotes. A semicolon doesn’t, but it doesn’t hurt if you do.</p>
</div>
</div>
</div>
<div id="detailed-specifications-for-each-cross-type" class="section level2">
<h2>Detailed specifications for each cross type</h2>
<div id="backcross" class="section level3">
<h3>Backcross</h3>
<p>The cross type for a backcross is <code>&quot;bc&quot;</code>. In the case that the X chromosome is included, a sex covariate needs to be included. The genotype codes are <code>1</code> for homozygotes and <code>2</code> for heterozygotes, and so the yaml control file will contain lines like the following:</p>
<pre><code>genotypes:
  AA: 1
  AB: 2</code></pre>
<p>The values on the left-hand side are the genotype codes in the genotype data file; the numbers on the right are the numeric codes they’ll be converted into.</p>
<p>The equivalent genotype code specification for a json control file is</p>
<pre><code>&quot;genotypes&quot;: {&quot;AA&quot;: 1, &quot;AB&quot;: 2}</code></pre>
</div>
<div id="f2-intercross" class="section level3">
<h3>F<sub>2</sub> intercross</h3>
<p>The cross type for an intercross between two inbred strains is <code>&quot;f2&quot;</code>.</p>
<p>The genotypes will be encoded as <code>1</code>, <code>2</code>, and <code>3</code> for say AA, AB, and BB. The yaml control file will contain lines like the following:</p>
<pre><code>genotypes:
  AA: 1
  AB: 2
  BB: 3</code></pre>
<p>The values on the left-hand side are the genotype codes in the genotype data file; the numbers on the right are the numeric codes they’ll be converted into. The equivalent json specification is:</p>
<pre><code>&quot;genotypes&quot;: {&quot;AA&quot;: 1, &quot;AB&quot;: 2, &quot;BB&quot;: 3}</code></pre>
<p>If the X chromosome is included in the data, we will need a sex covariate as well as cross information. The cross information for an intercross indicates the direction of the cross, with <code>0</code> corresponding to the forward direction, for example (A×B)&amp;times(A×B) with females listed first, and <code>1</code> corresponding to the reverse direction, for example (B×A)×(B×A). What matters is the direction for the cross that led to the males, since the F<sub>2</sub> females get an intact X chromosome from their father, which is A for the forward direction and B for the reverse. Different individuals can come from different directions, and you indicate the encodings with lines like the following:</p>
<pre><code>cross_info:
  covar: cross_direction
  (AxB)x(AxB): 0
  (BxA)x(BxA): 1</code></pre>
<p>Here, we’re saying that the covariate file has a column named “<code>cross_direction</code>” that contains the cross information, and that the forward direction is encoded as <code>(AxB)x(AxB)</code> and the reverse direction as <code>(BxA)x(BxA)</code>.</p>
<p>You can have multiple codes for the cross direction information. For example, the <code>cross_direction</code> covariate might use four possible codes, including not just <code>(AxB)x(AxB)</code> and <code>(BxA)x(BxA)</code>, but also <code>(BxA)x(AxB)</code>, and <code>(AxB)x(BxA)</code>.</p>
<p>In this case, the yaml control file should contain the following:</p>
<pre><code>cross_info:
  covar: cross_direction
  (AxB)x(AxB): 0
  (BxA)x(AxB): 0
  (BxA)x(BxA): 1
  (AxB)x(BxA): 1</code></pre>
<p>The equivalent json specification is:</p>
<pre><code>&quot;cross_info&quot;:{&quot;covar&quot;:&quot;cross_direction&quot;, &quot;(AxB)x(AxB)&quot;:0, &quot;(BxA)x(AxB)&quot;:0, &quot;(BxA)x(BxA)&quot;:1, &quot;(AxB)x(BxA)&quot;:1}</code></pre>
<p>If you’ve coded the cross direction as in <a href="http://rqtl.org">R/qtl</a>, with a covariate <code>pgm</code> with values <code>0</code> and <code>1</code>, your yaml file would contain the following lines.</p>
<pre><code>cross_info:
  covar: pgm
  0: 0
  1: 1</code></pre>
<p>The equivalent json is:</p>
<pre><code>&quot;cross_info&quot;: {&quot;covar&quot;: &quot;pgm&quot;, &quot;0&quot;: 0, &quot;1&quot;: 1}</code></pre>
<p>Here are some example R/qtl2 data files for F<sub>2</sub> intercrosses:</p>
<ul>
<li><p><a href="http://kbroman.org/qtl2/assets/sampledata/iron/"><code>iron</code></a> from <a href="https://www.ncbi.nlm.nih.gov/pubmed/16799992">Grant et al. (2006) Hepatology 44:174-185</a>. A <a href="http://kbroman.org/qtl2/assets/sampledata/iron/iron.zip">zip file for these data</a> is distributed with the <a href="https://github.com/rqtl/qtl2geno">R/qtl2geno</a> package.</p></li>
<li><p><a href="https://github.com/rqtl/qtl2data/tree/master/B6BTBR"><code>B6BTBR</code></a> from <a href="https://doi.org/10.1534/genetics.115.179432">Tian et al. (2015) Genetics 201:1253-1262</a> and <a href="https://doi.org/10.1534/g3.115.019778">Broman et al. (2015) G3 5:2177-2186</a>.</p></li>
<li><p><a href="https://github.com/rqtl/qtl2data/tree/master/Gough"><code>Gough</code></a> from <a href="https://doi.org/10.1534/genetics.115.177790">Gray et al. (2015) Genetics 201:213-228</a>.</p></li>
</ul>
</div>
<div id="recombinant-inbred-lines-ril" class="section level3">
<h3>Recombinant inbred lines (RIL)</h3>
<p>The cross types for a recombinant inbred lines derived from two inbred strains are <code>&quot;riself&quot;</code> and <code>&quot;risib&quot;</code> for RIL by selfing and sib-mating, respectively.</p>
<p>The genotypes will be encoded as <code>1</code> and <code>2</code>, and so the yaml control file needs lines like:</p>
<pre><code>genotypes:
  AA: 1
  BB: 2</code></pre>
<p>The json equivalent is:</p>
<pre><code>&quot;genotypes&quot;: {&quot;AA&quot;:1, &quot;BB&quot;:2}</code></pre>
<p>For RIL by selfing (<code>&quot;riself&quot;</code>), no X chromosome is allowed. For RIL by sib-mating (<code>&quot;risib&quot;</code>) with an X chromosome, no sex covariate is needed, as we’re working with genotypes that correspond to <code>_lines_</code> rather than <em>individuals</em>, and the males and females within a line will have the same X chromosome, it’s just that the females will have two copies of it.</p>
<p>But for RIL by sib-mating with the X chromosome, we do need a cross information covariate which indicates the direction in which the cross was performed: <code>0</code> for the forward direction A×B (where a female A was crossed to a male B) and <code>1</code> for the reverse direction B×A (where a female B was crossed to a male A). If the cross information column is absent, we assume that all individuals came from the forward direction.</p>
<p>The yaml control file needs lines to indicate the cross information covariate and the encodings; if there is a covariate named <code>cross_direction</code> with values <code>AxB</code> and <code>BxA</code>, the yaml lines would be like this:</p>
<pre><code>cross_info:
  covar: cross_direction
  AxB: 0
  BxA: 1</code></pre>
<p>The equivalent json is:</p>
<pre><code>&quot;cross_info&quot;: {&quot;covar&quot;: &quot;cross_direction&quot;, &quot;AxB&quot;: 0, &quot;BxA&quot;: 1}</code></pre>
<p>We don’t have example data files for RIL by sib-mating, but the <a href="https://github.com/rqtl/qtl2geno">R/qtl2geno</a> package includes data for a set of arabidopsis RIL by selfing from <a href="https://doi.org/10.1534/genetics.113.153346">Moore et al. (2013) Genetics 195:1077-1086</a>, <a href="http://kbroman.org/qtl2/assets/sampledata/grav2/"><code>grav2</code></a>. Here’s a zip file: <a href="http://kbroman.org/qtl2/assets/sampledata/grav2/grav2.zip"><code>grav2.zip</code></a>.</p>
</div>
<div id="doubled-haploids-dh" class="section level3">
<h3>Doubled haploids (DH)</h3>
<p>The cross type for doubled haploids is <code>&quot;dh&quot;</code>. We don’t allow an X chromosome, and don’t require sex or cross information. The genotypes will be encoded as <code>1</code> and <code>2</code>, just as for recombinant inbred lines, and the yaml or json control file will have lines for <code>genotype</code> that look just like those for <code>riself</code> and <code>risib</code>.</p>
</div>
<div id="haploids" class="section level3">
<h3>Haploids</h3>
<p>The cross type for haploids is <code>&quot;haploid&quot;</code>. As with doubled haploids, we don’t require sex or cross information, and the genotypes are coded as <code>1</code> and <code>2</code>. The only difference between the <code>&quot;haploid&quot;</code> and <code>&quot;dh&quot;</code> cross types is the labels that are attached to the two genotypes: single-letter codes for haploids and double-letter homozygotes for doubled haploids.</p>
</div>
<div id="advanced-intercross-lines-ail" class="section level3">
<h3>Advanced intercross lines (AIL)</h3>
<p>The cross type for advanced intercross lines derived from two inbred strains is <code>&quot;ail&quot;</code>. Genotypes are coded <code>1</code>, <code>2</code>, and <code>3</code>, just as with the F<sub>2</sub> intercross (cross type <code>&quot;f2&quot;)</code>. If an X chromosome is included, we need a sex covariate just as for the intercross.</p>
<p>Cross information needs to include two columns: the number of generations (for example, 12 for an AIL individual from generation F<sub>12</sub>), and the cross direction. Cross direction takes 3 possible values: <code>0</code> if the initial F<sub>1</sub> individuals all came from an A×B cross (with a female A crossed to a male B), <code>1</code> if the initial F<sub>1</sub> individuals all came from a B×A cross (with a female B crossed to a male A), and <code>2</code> if the initial F<sub>1</sub> individuals were a balanced mixture of the two cross directions.</p>
<p>Because the cross information needs two columns, it can be provided through a covariate but rather needs to be included as a separate file, and the columns won’t be re-coded in any way; the first column needs to contain the generation numbers and the second column needs to contain cross direction coded as <code>0</code>, <code>1</code>, and <code>2</code>.</p>
<p>If cross information is stored in a file <code>mycross_crossinfo.csv</code>, the yaml control file shoul contain a line like:</p>
<pre><code>cross_info: mycross_crossinfo.csv</code></pre>
<p>The json equivalent is the same but needs quotes:</p>
<pre><code>&quot;cross_info&quot;: &quot;mycross_crossinfo.csv&quot;</code></pre>
</div>
<div id="diversity-outbreds-do" class="section level3">
<h3>Diversity Outbreds (DO)</h3>
<p>The cross type for the Diversity Outbred mouse population is <code>&quot;do&quot;</code>.</p>
</div>
<div id="heterogeneous-stock-hs" class="section level3">
<h3>Heterogeneous stock (HS)</h3>
<p>The cross type for the heterogenous stock derived from 8 inbred strains is <code>&quot;hs&quot;</code>.</p>
</div>
<div id="multi-parent-recombinant-inbred-lines" class="section level3">
<h3>Multi-parent recombinant inbred lines</h3>
<p>R/qtl2 can handle multi-parent recombinant inbred lines by selfing in the case of 4, 8, or 16 founder lines (<code>&quot;riself4&quot;</code>, <code>&quot;riself8&quot;</code>, and <code>&quot;riself16&quot;</code>), and by sib-mating in the case of 4 or 8 founder lines (<code>&quot;risib4&quot;</code> and <code>&quot;risib8&quot;</code>). The Collaborative Cross (CC) is an example of 8-way RIL by sib-mating (<code>&quot;risib8&quot;</code>). Many MAGIC populations are also examples of multi-way RIL by sibling mating.</p>
<p>Two related cross types are <code>&quot;magic19&quot;</code> and <code>&quot;dh6&quot;</code>. The <code>&quot;magic19&quot;</code> cross type is specific for the 19-way Arabidopsis MAGIC lines of <a href="https://doi.org/10.1371/journal.pgen.1000551">Kover et al (2009) PLOS Genet 5:e1000551 doi:10.1371/journal.pgen.1000551</a>. This was derived from a full diallel (in both directions) among 19 strains followed by 3 generations of random mating (to F4) and then selfing for 6 generations. The <code>&quot;dh6&quot;</code> cross type is for a set of maize MAGIC populations developed at the Wisconsin Crop Innovation Center: A diallel of 6 founders followed by random mating for some number of generations and then derivation of doubled haploids.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

      </div>
      <hr>
      <footer>
        <p><small>
  <!-- start of Karl's footer; modify this part -->
          <a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="CC BY"/></a> &nbsp;
          <a href="http://kbroman.org">Karl Broman</a>
  <!-- end of Karl's footer; modify this part -->
        </small></p>
      </footer>

    </div>
