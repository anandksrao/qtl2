context("expand snp association results to include all snps")

test_that("expand_snp_results() works", {

    # this is a contrived example; basically a regression test

    out_snps <- structure(list(lod = structure(c(2.3417662372334, 4.60060546129196,
                               0.0260449600421917, 0.726631203827458, 0.212138538993095),
                               .Dim = c(5L,
                               1L), .Dimnames = list(c("rs221396738", "rs264175039", "rs229722012",
                                    "rs227574143", "rs27379133"), "OF_immobile_pct")),
                               map = structure(list(
                               `2` = structure(c(96.500012, 96.500224, 96.500343, 96.500668,
                               96.501406),
                               .Names = c("rs221396738",
                               "rs264175039", "rs229722012", "rs227574143", "rs27379133"))),
                               .Names = "2"),
                               snpinfo = structure(list(
                               `2` = structure(list(snp_id = c("rs221396738", "rs264175039",
                                                    "rs227493750", "rs229722012", "rs27379137", "rs227574143",
                                                    "rs27379136", "rs216849408", "rs240457950", "rs263973399",
                                                    "rs27379135", "rs27379134", "rs238531859", "rs27379133",
                                                    "rs235268653", "rs260595137", "rs219597400", "rs220959761",
                                                    "rs241157930", "rs251406434"),
                               chr = c("2", "2", "2", "2",
                               "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2",
                               "2", "2", "2", "2"),
                               pos_Mbp = c(96.500012, 96.500224, 96.500276,
                               96.500343, 96.500437, 96.500668, 96.500749, 96.501004, 96.501091,
                               96.501096, 96.501138, 96.501283, 96.501312, 96.501406, 96.501861,
                               96.501951, 96.50198, 96.501993, 96.502069, 96.502099),
                               alleles = c("C|T",
                               "A|C", "C|T", "C|G", "C|T", "A|C", "A|C", "A|G", "C|A", "T|A",
                               "A|T", "A|C", "A|T", "A|T", "C|T", "T|A", "C|T", "G|T", "A|C",
                               "C|G"),
                               sdp = c(32L,
                               16L, 16L, 176L, 32L, 144L, 176L, 176L, 144L, 144L, 144L,
                               176L, 32L, 189L, 32L, 32L, 32L, 32L, 32L, 32L),
                               index = c(1L,
                               2L, 2L, 3L, 1L, 4L, 3L, 3L, 4L, 4L, 4L, 3L, 1L, 5L, 1L,
                               1L, 1L, 1L, 1L, 1L)),
                               .Names = c("snp_id", "chr", "pos_Mbp",
                               "alleles", "sdp", "index"),
                               row.names = c(1L, 2L, 3L, 4L, 5L,
                               6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 16L, 17L, 18L, 19L,
                               20L, 22L), class = "data.frame")), .Names = "2")),
                          .Names = c("lod",
                          "map", "snpinfo"), class = c("scan1", "matrix"))


    expected <- structure(list(lod = structure(c(2.3417662372334, 4.60060546129196,
                               4.60060546129196, 0.0260449600421917, 2.3417662372334, 0.726631203827458,
                               0.0260449600421917, 0.0260449600421917, 0.726631203827458, 0.726631203827458,
                               0.726631203827458, 0.0260449600421917, 2.3417662372334, 0.212138538993095,
                               2.3417662372334, 2.3417662372334, 2.3417662372334, 2.3417662372334,
                               2.3417662372334, 2.3417662372334), .Dim = c(20L, 1L),
                               .Dimnames = list(
                               c("rs221396738", "rs264175039", "rs264175039", "rs229722012",
                                 "rs221396738", "rs227574143", "rs229722012", "rs229722012",
                                 "rs227574143", "rs227574143", "rs227574143", "rs229722012",
                                 "rs221396738", "rs27379133", "rs221396738", "rs221396738",
                                 "rs221396738", "rs221396738", "rs221396738", "rs221396738"
                                 ), "OF_immobile_pct")),
                               map = structure(list(`2` = structure(c(96.500012,
                                                    96.500224, 96.500276, 96.500343, 96.500437, 96.500668, 96.500749,
                                                    96.501004, 96.501091, 96.501096, 96.501138, 96.501283, 96.501312,
                                                    96.501406, 96.501861, 96.501951, 96.50198, 96.501993, 96.502069,
                                                    96.502099),
                                                    .Names = c("rs221396738", "rs264175039", "rs227493750",
                                                    "rs229722012", "rs27379137", "rs227574143", "rs27379136", "rs216849408",
                                                    "rs240457950", "rs263973399", "rs27379135", "rs27379134", "rs238531859",
                                                    "rs27379133", "rs235268653", "rs260595137", "rs219597400", "rs220959761",
                                                    "rs241157930", "rs251406434"))), .Names = "2")),
                          .Names = c("lod", "map"))

    expect_equal(expand_snp_results(out_snps), expected)

})
